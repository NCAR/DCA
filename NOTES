GENERAL NOTES

MPAS is unsynchronized, which explains why there's no signal.
If there's no synchrony, it can't fit into this framework...

-------------
SCRIPTS

1) ingest.R generates:

data/prec.Rdata				# precip data

gcm
methods[]
periods[]
perspan[]  ## string "YYYY-YYYY"
prec$period[method,px,py,day,month,year]
px[]
py[]


data/ua.Rdata				# MPI upper atmosphere data

gcm
lats[]					# string-formatted; 2 decimals
lat[]
lon[]
periods[]
perspan[]
uaunits
ua$period[var,lon,lat,day,month,year]
vars[]


2) bucket.R: 

data/buckets.Rdata			# precip aggregated by amount

buckets						# dry / moist / wet
bprec$period[method,px,py,day,month,year]	# bucketized precip
bstat${count|pct}$period[bucket,method,px,py,month]
theta						# 3 mm threshold
trace						# 0.254 mm = 1/100" threshold


3) anomaly.R generates:

data/$gcm/anom/total.Rdata			# climatology/anomaly decompos'n

baseline$period[var, px, py]			# average over all time
totanom$period[var, px, py, month]		# climatology minus baseline
totclim$period[var, px, py, month]		# avg over month across years

data/$gcm/anom/sgp/$x.$y/$period.$month.$x.$y.Rdata
anom[bucket,method,var,lon,lat]		# clim minus baseline
clim[bucket,method,var,lon,lat]		# avg over month & bucket across years
delta[bucket,method,var,lon,lat]	# anom minus totanom
gcm
loc
mon
period


-------------
A) barplots.R				# barplots of bucket stats



-------------

date
R -f ingest.R
date
R -f bucket.R
date
R -f anomaly.R


-------------
TODO

# github repo

# plotfun commentary

# move .Rdata files into data

# bucketize precip
# bucket plots:
# stacked barplot by method w/ o/c/f
. unstacked "
.iterate + gangplot
.	by method?  by month (calendar layout?)

.gangplot: layout + function + f'n args

# calculate anomaly by bucket
gridmaps: may climatology (baseline + bucketized)
gridmaps: may anomaly (baseline + bucketized)
layout A & B: plot = bucket, row = method & vice-versa
all x o,c,f


PCA on daily may anomalies
varimax rotation on modes
x metR package?  (rotate=TRUE for varimax...)
CSTools - multivariate EOF
	need to merge YMD using R.utils::(un?)wrap()
	edit ingest to use R.utils?


precip distplots: all, month

instp precip plots w/ calendar layout?


taylor diagrams: anomaly (current and future)
taylor diagrams: change pattern


mismatch days 3x3 barchart
mismatch days anomaly gridmaps (subset by acceptable # days)


ssim similarity matrix on may daily anomalies
total = linear sum of SSIM for each variable
also f(prec) [factor(bucket) = (0,1,2)/2?] as component of total?
hclust on ssim matrix
PCA based on ssim matrix?

distributions of ssim by bucket mismatch


see self-email for packages for SSIM, PCA, varimax



add method: regression model(s?) using downscaleR
run over all CONUS gridcells?


get util.R .checkargs() to work


other regions:
      Yakima river basin
      Tuolumnee river basin
      Upper CO r.b. @ Cameo CO
      Phoenix

-------------------

NOTES

MPI uses standard gregorian calendar *with* leap-days.
WRF-MPI skips the leap days (365-day calendar).

